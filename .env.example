# ============================================
# Mudrex API Bot - Environment Configuration
# ============================================
# Copy this file to .env and fill in your values

# ============================================
# REQUIRED SETTINGS
# ============================================

# Telegram Bot Token (from @BotFather)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# Google Gemini API Key
GEMINI_API_KEY=your_gemini_api_key_here

# ============================================
# MUDREX API (Optional - for live data)
# ============================================

# Mudrex API Secret (Your Personal Key)
# Use YOUR personal API secret from Mudrex
# Bot uses this to fetch public market data (prices, contracts, status)
# Bot code blocks personal account queries for security
# Get from: Mudrex → Settings → API Key Management
MUDREX_API_SECRET=your_api_secret_here

# ============================================
# ACCESS CONTROL (Optional)
# ============================================

# Restrict bot to specific Telegram chat IDs (comma-separated)
# Leave empty to allow all chats
# ALLOWED_CHAT_IDS=123456789,-987654321

# Admin user IDs for escalation (comma-separated)
# ADMIN_USER_IDS=123456789

# ============================================
# AI MODEL SETTINGS
# ============================================

# Gemini Model (default: gemini-3-flash-preview)
GEMINI_MODEL=gemini-3-flash-preview

# Temperature (0.0-1.0, lower = more focused)
GEMINI_TEMPERATURE=0.4

# Max response tokens
GEMINI_MAX_TOKENS=2048

# ============================================
# RAG SETTINGS
# ============================================

# Vector database directory
CHROMA_PERSIST_DIR=./data/chroma

# Embedding model
EMBEDDING_MODEL=models/gemini-embedding-001

# Number of documents to retrieve
TOP_K_RESULTS=5

# Minimum similarity score (0.0-1.0)
SIMILARITY_THRESHOLD=0.55

# ============================================
# BOT BEHAVIOR
# ============================================

# Max response length (Telegram limit is 4096)
MAX_RESPONSE_LENGTH=4000

# Only respond to API-related questions
ONLY_RESPOND_TO_QUESTIONS=true

# Auto-detect if message is a query
AUTO_DETECT_QUERIES=true

# ============================================
# MCP SETTINGS
# ============================================

# Enable MCP integration for live API data
MCP_ENABLED=true

# MCP server URL
MCP_BASE_URL=https://mudrex.com/mcp

# MCP request timeout (seconds)
MCP_TIMEOUT=15

# ============================================
# RATE LIMITING
# ============================================

# Max messages per user per window
RATE_LIMIT_MESSAGES=30

# Rate limit window (seconds)
RATE_LIMIT_WINDOW=60

# ============================================
# GROUNDING AND CHANGELOG WATCHER
# ============================================

# Model for Google Search grounding when RAG has no docs (out-of-context API questions)
GEMINI_GROUNDING_MODEL=gemini-2.5-flash

# Daily scrape of docs.trade.mudrex.com; if changelog changes, broadcast to ALLOWED_CHAT_IDS.
# If ALLOWED_CHAT_IDS is unset or empty, no broadcast is sent.
ENABLE_CHANGELOG_WATCHER=true

# Cron: hour (0-23) and minute for daily job (default 2:00 AM UTC)
CHANGELOG_CRON_HOUR=2
CHANGELOG_CRON_MINUTE=0

# Daily futures listing check: MCP list_futures, diff vs last snapshot; if newly listed or delisted, broadcast to ALLOWED_CHAT_IDS.
ENABLE_FUTURES_LISTING_WATCHER=true
